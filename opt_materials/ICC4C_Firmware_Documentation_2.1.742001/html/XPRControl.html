<!-- HTML header for doxygen 1.8.16-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="shortcut icon" href="adara_icon.png" type="image/x-icon" />
<title>ICC4C: XPR Control System</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="https://www.optotune.com/" target="_blank"><img alt="Logo" src="optotune_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ICC4C
   &#160;<span id="projectnumber">143-525-00</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">XPR Control System </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >XPR Control System ID: <b>0x2E</b></p>
<p >XPR Control system provides interface for simple control of XPR devices. Firstly, active channel should be selected - XPR device always uses pairs of outputs channels. Active channel parameter selects the first channel of the pair. FW automatically checks whether XPR device was detected on desired channel and updates Device Model ID register. Upon reception of RUN command to Control register, XPR system loads reference signal from Edgetables according desired framerate and waveform shape. Reference signal is resampled to ICC4C sampling rate (&lt;= 20 kHz, depending on frame rate) and loaded into Vector Pattern Memory. Resampled signal can be read directly from VPM. When loading is done correctly, XPR control system configures Vector Pattern Units according to desired frame rate and starts with driving of XPR device. Waveform driving can be paused using STOP command. XPR Control system requires decoding of Edge tables from XPR EEPROM. Currently supported for XPR20, XPR33, XPR18 and XPR26.</p>
<h3>Register Map:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Address   </th><th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Default Value   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Access    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x2E00   </td><td class="markdownTableBodyNone">FRAME RATE   </td><td class="markdownTableBodyNone">50   </td><td class="markdownTableBodyNone">Desired frame rate of control signals in Hz: 50 Hz, 60 Hz, ...   </td><td class="markdownTableBodyNone">uint32   </td><td class="markdownTableBodyNone">read write    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x2E01   </td><td class="markdownTableBodyNone">WAVEFORM SHAPE   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Desired waveform shape (index of Edgetable)   </td><td class="markdownTableBodyNone">uint32   </td><td class="markdownTableBodyNone">read write    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x2E02   </td><td class="markdownTableBodyNone">CONTROL   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Control/Status register: <br  />
 Read -&gt; 0 - Idle state, 1 - Running, 2 - Error <br  />
 Write -&gt; 0 - Stop control, 1 - Run   </td><td class="markdownTableBodyNone">uint32   </td><td class="markdownTableBodyNone">read write    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x2E03   </td><td class="markdownTableBodyNone">DEVICE MODEL   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Device ID: 0 - no XPR device, XPR20 - 1, XPR33 - 8, XPR18 - 29, XPR26 - 31   </td><td class="markdownTableBodyNone">uint32   </td><td class="markdownTableBodyNone">read only    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x2E04   </td><td class="markdownTableBodyNone">VPU LENGTH   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Calculated length of VPU signal - from framerate   </td><td class="markdownTableBodyNone">uint32   </td><td class="markdownTableBodyNone">read only    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x2E05   </td><td class="markdownTableBodyNone">VPU SAMPLING   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Calculated sampling frequency of VPU signal - from framerate   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">read only    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x2E06   </td><td class="markdownTableBodyNone">ACTIVE CHANNEL   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Active channel for XPR control. Possible values: 0, 1, 2   </td><td class="markdownTableBodyNone">uint32   </td><td class="markdownTableBodyNone">read write    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x2E07   </td><td class="markdownTableBodyNone">SUPPORTED FRAMERATES COUNT   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Number of supported framerates read from EEPROM. Defines number of valid values of related vector   </td><td class="markdownTableBodyNone">uint8   </td><td class="markdownTableBodyNone">read only   </td></tr>
</table>
<p >The XPR Control system supports the following vectors (vectors have their own address space):</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Address   </th><th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Format and value   </th><th class="markdownTableHeadNone">Access    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x2E00   </td><td class="markdownTableBodyNone">Reference signal channel 0   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Reference signal read from Edgetable in EEPROM (length 512)   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">read only    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">0x2E01   </td><td class="markdownTableBodyNone">Reference signal channel 1   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Reference signal read from Edgetable in EEPROM (length 512)   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">read only    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0x2E02   </td><td class="markdownTableBodyNone">Supported frame rates   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">Return vector of supported frame rates for actual device (length can be read from register 0x2E07   </td><td class="markdownTableBodyNone">float   </td><td class="markdownTableBodyNone">read only   </td></tr>
</table>
<p >Notes: <br  />
</p><ol type="1">
<li>As first step active channel has to be set. Even default value 0 needs to be written in order to load Device model ID.</li>
<li>Check Device model ID, check supported frame rates.</li>
<li>Set desired frame rate in Hz. Value is checked with supported frame rates read from EEPROM. If desired frame rate is not supported, error is returned.</li>
<li>write Run command into Control Register (value 1) - waveform is loaded from EEPROM and VPU is started.</li>
<li>Check waveforms in Edgetable that was loaded from EEPROM using vectors, or check VPM content</li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<hr class="footer"/><address class="footer"><small>
<a href="https://www.optotune.com/" target="_blank">Optotune. All rights reserved. 
</a>
</small></address>
</body>
</html>
